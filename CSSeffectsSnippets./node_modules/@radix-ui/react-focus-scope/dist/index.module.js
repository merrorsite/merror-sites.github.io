import{useCallbackRef as e}from"@radix-ui/react-use-callback-ref";import*as t from"react";const n={bubbles:!1,cancelable:!0};export function FocusScope(c){const{children:i,trapped:a=!1}=c,[d,f]=t.useState(null),l=e(c.onMountAutoFocus),m=e(c.onUnmountAutoFocus),p=t.useRef(null),v=a,E=a,F=t.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;t.useEffect((()=>{if(d){s.add(F);const e=document.activeElement;d.addEventListener("focusScope.autoFocusOnMount",l),d.addEventListener("focusScope.autoFocusOnUnmount",m);const t=new Event("focusScope.autoFocusOnMount",n);return d.dispatchEvent(t),t.defaultPrevented||(!function(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(r(o,{select:t}),document.activeElement!==n)return}(o(d),{select:!0}),document.activeElement===e&&r(d)),()=>{d.removeEventListener("focusScope.autoFocusOnMount",l),setTimeout((()=>{const t=new Event("focusScope.autoFocusOnUnmount",n);d.dispatchEvent(t),t.defaultPrevented||r(null!=e?e:document.body,{select:!0}),d.removeEventListener("focusScope.autoFocusOnUnmount",m),s.remove(F)}),0)}}}),[d,l,m,F]);const S=t.useCallback((e=>{if(!v&&!E)return;if(F.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){const t=e.currentTarget,[c,s]=function(e){const t=o(e),n=u(t,e),c=u(t.reverse(),e);return[n,c]}(t);c&&s?e.shiftKey||n!==s?e.shiftKey&&n===c&&(e.preventDefault(),v&&r(s,{select:!0})):(e.preventDefault(),v&&r(c,{select:!0})):n===t&&e.preventDefault()}}),[v,E,F.paused]);return t.useEffect((()=>{if(E){function e(e){if(F.paused||!d)return;const t=e.target;d.contains(t)?p.current=t:r(p.current,{select:!0})}function t(e){!F.paused&&d&&(d.contains(e.relatedTarget)||r(p.current,{select:!0}))}return document.addEventListener("focusin",e),document.addEventListener("focusout",t),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t)}}}),[E,d,F.paused]),i({ref:t.useCallback((e=>f(e)),[]),tabIndex:-1,onKeyDown:S})}function o(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function u(e,t){for(const n of e)if(!c(n,{upTo:t}))return n}function c(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function r(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}const s=function(){let e=[];return{add(t){const n=e[0];t!==n&&(null==n||n.pause()),e=i(e,t),e.unshift(t)},remove(t){var n;e=i(e,t),null===(n=e[0])||void 0===n||n.resume()}}}();function i(e,t){const n=[...e],o=n.indexOf(t);return-1!==o&&n.splice(o,1),n}export const Root=FocusScope;
//# sourceMappingURL=index.module.js.map
